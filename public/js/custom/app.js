class AppClass {

    // MÃ©todo para crear el HTML de la lista de emojis
    createEmojiPicker() {
        return `
            <div class="form__emoji-picker" style="display: none; margin-top: 10px;">
                <span class="form__emoji">ğŸ˜Š</span>
                <span class="form__emoji">ğŸ˜‚</span>
                <span class="form__emoji">ğŸ˜</span>
                <span class="form__emoji">ğŸ˜‰</span>
                <span class="form__emoji">ğŸ˜­</span>
                <span class="form__emoji">ğŸ˜</span>
                <span class="form__emoji">ğŸ˜¡</span>
                <span class="form__emoji">ğŸ¥º</span>
                <span class="form__emoji">ğŸ˜œ</span>
                <span class="form__emoji">ğŸ¤”</span>
                <span class="form__emoji">ğŸ‘</span>
                <span class="form__emoji">ğŸ™</span>
                <span class="form__emoji">â¤ï¸</span>
                <span class="form__emoji">ğŸ‰</span>
                <span class="form__emoji">ğŸ”¥</span>
                <span class="form__emoji">ğŸ¤¯</span>
                <span class="form__emoji">ğŸ¤©</span>
                <span class="form__emoji">ğŸ˜‡</span>
                <span class="form__emoji">ğŸ¥³</span>
                <span class="form__emoji">ğŸ¤ª</span>
                <span class="form__emoji">ğŸ‘€</span>
                <span class="form__emoji">ğŸ˜</span>
                <span class="form__emoji">ğŸ’€</span>
                <span class="form__emoji">ğŸ‘»</span>
                <span class="form__emoji">ğŸ¤¤</span>
                <span class="form__emoji">ğŸ˜´</span>
                <span class="form__emoji">ğŸ‘‘</span>
                <span class="form__emoji">ğŸ’©</span>
                <span class="form__emoji">ğŸ¦„</span>
                <span class="form__emoji">ğŸ¶</span>
                <span class="form__emoji">ğŸ±</span>
                <span class="form__emoji">ğŸ­</span>
                <span class="form__emoji">ğŸ°</span>
                <span class="form__emoji">ğŸ»</span>
                <span class="form__emoji">ğŸ¼</span>
                <span class="form__emoji">ğŸ¸</span>
                <span class="form__emoji">ğŸ¦Š</span>
                <span class="form__emoji">ğŸµ</span>
                <span class="form__emoji">ğŸ¦‰</span>
                <span class="form__emoji">ğŸ¢</span>
                <span class="form__emoji">ğŸ</span>
                <span class="form__emoji">ğŸ¯</span>
                <span class="form__emoji">ğŸ¦</span>
                <span class="form__emoji">ğŸ‰</span>
                <span class="form__emoji">ğŸ¦š</span>
                <span class="form__emoji">ğŸŒˆ</span>
                <span class="form__emoji">ğŸŒ»</span>
                <span class="form__emoji">ğŸŒ¸</span>
                <span class="form__emoji">ğŸŒ¼</span>
                <span class="form__emoji">ğŸŒ·</span>
                <span class="form__emoji">ğŸ</span>
                <span class="form__emoji">ğŸŒ</span>
                <span class="form__emoji">ğŸ‰</span>
                <span class="form__emoji">ğŸ‡</span>
                <span class="form__emoji">ğŸ“</span>
                <span class="form__emoji">ğŸŠ</span>
                <span class="form__emoji">ğŸ‘</span>
                <span class="form__emoji">ğŸ¥­</span>
                <span class="form__emoji">ğŸ</span>
                <span class="form__emoji">ğŸ¥¥</span>
                <span class="form__emoji">ğŸ…</span>
                <span class="form__emoji">ğŸ¥—</span>
                <span class="form__emoji">ğŸ”</span>
                <span class="form__emoji">ğŸ•</span>
                <span class="form__emoji">ğŸŒ­</span>
                <span class="form__emoji">ğŸŸ</span>
                <span class="form__emoji">ğŸ¿</span>
                <span class="form__emoji">ğŸ¥˜</span>
                <span class="form__emoji">ğŸ²</span>
                <span class="form__emoji">ğŸ°</span>
                <span class="form__emoji">ğŸ¦</span>
                <span class="form__emoji">ğŸ©</span>
                <span class="form__emoji">ğŸª</span>
                <span class="form__emoji">ğŸ‚</span>
                <span class="form__emoji">ğŸ‰</span>
                <span class="form__emoji">ğŸ¾</span>
                <span class="form__emoji">ğŸ¸</span>
                <span class="form__emoji">ğŸ¹</span>
                <span class="form__emoji">ğŸº</span>
                <span class="form__emoji">ğŸ¥‚</span>
                <span class="form__emoji">ğŸ§Š</span>
                <span class="form__emoji">â˜•</span>
                <span class="form__emoji">ğŸ§‹</span>
                <span class="form__emoji">ğŸµ</span>
                <span class="form__emoji">ğŸ¶</span>
                <span class="form__emoji">ğŸ¥¤</span>
                <span class="form__emoji">ğŸ¥›</span>
                <span class="form__emoji">ğŸ¥¡</span>
                <span class="form__emoji">ğŸ™</span>
                <span class="form__emoji">ğŸš</span>
                <span class="form__emoji">ğŸ±</span>
                <span class="form__emoji">ğŸ›</span>
                <span class="form__emoji">ğŸ¥Ÿ</span>
                <span class="form__emoji">ğŸ¥™</span>
                <span class="form__emoji">ğŸŒ®</span>
                <span class="form__emoji">ğŸŒ¯</span>
                <span class="form__emoji">ğŸ¢</span>
                <span class="form__emoji">ğŸŒ¿</span>
                <span class="form__emoji">ğŸ†</span>
                <span class="form__emoji">âš½</span>
                <span class="form__emoji">ğŸ€</span>
                <span class="form__emoji">ğŸ¾</span>
                <span class="form__emoji">ğŸ³</span>
                <span class="form__emoji">ğŸ‹ï¸â€â™‚ï¸</span>
                <span class="form__emoji">ğŸ¤¸â€â™‚ï¸</span>
                <span class="form__emoji">â›·ï¸</span>
                <span class="form__emoji">ğŸš´â€â™‚ï¸</span>
                <span class="form__emoji">ğŸš£â€â™‚ï¸</span>
            </div>`;
    }

    initEmojiPicker(formClass, emojiContainerClass, toggleButtonClass, commentInputClass) {
        // Mostrar y ocultar el selector de emojis de manera contextual para cada formulario
        $(formClass).each((index, formElement) => {
            const form = $(formElement);

            // Crear el emoji picker y aÃ±adirlo dentro del contenedor de emojis
            const emojiPicker = this.createEmojiPicker();
            form.find(emojiContainerClass).append(emojiPicker);

            // Mostrar/ocultar emojis solo dentro del formulario actual
            form.find(toggleButtonClass).on('click', function () {
                form.find('.form__emoji-picker').toggle();
            });

            // AÃ±adir emojis al input de comentario del formulario actual
            form.find('.form__emoji').on('click', function () {
                let comentarioInput = form.find(commentInputClass);
                comentarioInput.val(comentarioInput.val() + $(this).text());
            });
        });
    }

    // MÃ©todo para vista preliminar de imÃ¡genes
    changeImagePreview($imageFileInput, $previeImage) {
        let currentImageSrc = $previeImage.attr('src'); // Almacena la imagen actual

        // Evento que se dispara al cambiar el input de archivo
        $imageFileInput.on('change', function (event) {
            const file = event.target.files[0]; // Obtiene el archivo seleccionado

            if (file) {
                const reader = new FileReader();

                reader.onload = function (e) {
                    // Actualiza la imagen de vista previa
                    $previeImage.attr('src', e.target.result);
                    $previeImage.show();
                };

                reader.readAsDataURL(file); // Lee el archivo como una URL
            } else {
                // Si no hay archivo, restaura la imagen anterior
                $previeImage.attr('src', currentImageSrc);
            }
        });
    }

    // Funcionalidades
    startAppClass() {
        // Crear Publicacion
        this.initEmojiPicker('.form-publication__create', '.form__cntn-emojis', '.modal__button--emoji-toggle', '.publication-input');
        this.changeImagePreview($('#image-file-create-publication'), $('#previe-create-publication'));
        // Comentarios
        this.initEmojiPicker('.form__comments', '.form__cntn-emojis', '.form__emojis-toggle', '.comentario-input');
        // Chat
        this.initEmojiPicker('.chat-container', '.form__cntn-emojis', '.chat__emojis-toggle', '.chat__input');
        // User Perfil
        this.changeImagePreview($('#image-file-perfil-user'), $('#previe-perfil-user'));
    }
}

window.initApp = new AppClass();
window.initApp.startAppClass();

